<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.2/css/bootstrap.min.css' integrity='sha512-b2QcS5SsA8tZodcDtGRELiGv5SaKSk1vDHDaQRda0htPYWZ6046lr3kJ5bAAQdpV2mmA/4v0wQF9MyU6/pDIAg==' crossorigin='anonymous'/>
  <title>Document</title>
  <style>
    body{
      padding-bottom: 500px;
    }

    h3{
      margin: 20px 0;
    }

    .box1,
    .box1-1,
    .box2,
    .box3,
    .box4,
    .box5,
    .box6,
    .box7,
    .box8,
    .box9,
    .box10,
    .box11{
      width: 50px;
      height: 50px;
      background: #000;
      margin: 5px;
    }

    .box2{
      background: red;
    }

    .box3{
      background: blue;
    }

    .box4{
      background: green;
    }

  </style>
</head>
<body>
  <div class="container">
    <h2>gsap 全域物件</h2>
    <ul>
      <li>
        使用 gsap.to()、gsap.from()、gsap.fromTo() 三種建立tween補件動畫。
      </li>
      <li>
        使用 gsap.timeline() 建立時間軸，他是補間動畫或其他時間軸的容器。
      </li>
    </ul>
    <h3>1. 選擇目標</h3>
    <div class="box1"></div>
    <div class="box1-1"></div>

    <hr>

    <h3>2. 選擇幾個群組時使用陣列</h3>
    <div class="box2"></div>
    <div class="box2"></div>
    <div class="box2"></div>
    <div class="box3"></div>
    <div class="box3"></div>
    <div class="box3"></div>
    <div class="box4"></div>
    <div class="box4"></div>
    <div class="box4"></div>

    <hr>
    <h3>3. 絕對數值</h3>
    <div class="box5"></div>

    <hr>

    <h3>4. 相對數值</h3>
    <div class="box6"></div>

    <hr>

    <h3>5. 隨機函式值(字串)</h3>
    <div class="box7"></div>
    <div class="box7"></div>
    <div class="box7"></div>

    <hr>

    <h3>6. 函式做為值</h3>
    <div class="box8"></div>
    <div class="box8"></div>
    <div class="box8"></div>

    <h3>7. 設定CSS屬性</h3>
    <div class="box9" style="margin: auto;"></div>
    <p id="word">
      家人看出結婚哪些措施家電原則價格網上一句我很大戰，不了制定第一個放在圖片本帖由此，當時資產，二十對外，禁止手機鈴聲身體我國實際上生活調查無比禁止給我們，回到以便填寫他說從而回應利用其他保護圖像化讓她短信參與，業主昨日學院分類夥伴目標有一定及其，後來女人面。
    </p>

    <hr>

    <h3>8. 設定動畫屬性</h3>
    <div class="box10"></div>
    <button id="play">play</button>
    <button id="pause">pause</button>

    <hr>

    <h3>9. keyframes 關鍵影格</h3>
    <p>讓單一補間動畫具有更多連續動作</p>
    <div class="box11"></div>
  </div>

  <script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js' integrity='sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==' crossorigin='anonymous'></script>
  <!-- 設定gsap主程式 -->
  <script src="./gsap.js"></script>
  <script>
    // 1. 選擇目標 ---------------------------------
    // (1) 用js選擇目標
    const b1 = document.querySelector('.box1')
    // (2) 用jQ選擇目標
    const b2 = $('.box1')
    // gsap.to('目標', {物件}) 建立一個補間動畫，從目前狀態 到 設定狀態
    // 在{物件}設定屬性，ex: CSS屬性或是gsap動畫屬性
    const tween1 = gsap.to(b1, {
      x: 500,
      duration: 3
    })
    // (3) 直接在tween 內使用CSS規範選擇器來選擇目標 (推薦)
    const tween11 = gsap.to('.box1-1', {
      x: 400, 
      duration: 2
    })

    // 2. 選擇幾個群組時使用陣列 ----------------------
    const dom1 = document.querySelectorAll('.box2')
    const dom2 = document.querySelectorAll('.box3')
    const dom3 = document.querySelectorAll('.box4')

    const jq1 = $('.box2')
    const jq2 = $('.box3')
    const jq3 = $('.box4')

    const tween2 = gsap.to(['.box2', '.box3'], {
      x: 500, 
      duration: 3
    })

    const tween2_2 = gsap.to('.box3, .box4', {
      x: 500, 
      duration: 3
    })

    // 3. 絕對數值 -----------------------------------
    const tween3 = gsap.to('.box5', {
      // x: 500, // 絕對數值，使用無單位的數字
      // x: '500px', // 絕對數值，使用有單位的數字
      // x: '100%', =
      xPercent: 100, // 100 = translateX(100%)
      duration: 3
    })

    // 4. 相對數值 -----------------------------------
    // 鄉對數值的好處: 可以搭配repeat、repeatRefresh 使用，做到紀錄每次動畫的屬性值，並在下次重複動畫時，以此屬性值作為開始
    let myVar = 300
    const tween4 = gsap.to('.box6', {
      x: '+=200', // 相對數值，使用 += or -=
      x: `+=${myVar}`,
      repeat: 3,  // 不包含初始撥放的那一次 所以總共播四次
      repeatRefresh: true, // 記錄到每個結束位置，繼續做動畫下去 (須配合相對數值)
      duration: 1
    })

    // 5. 隨機函式值(字串) ---------------------------
    const tween5 = gsap.to('.box7', {
      // x: 'random(0, 1000)', // 0~1000隨機數字
      x: 'random(500, 1000, 500)', // 500~1000隨機數字，且每次都是500的倍數
      background: 'random([red, green, blue])', // 從陣列中隨機選擇
      border: '7px random([solid, dashed, double]) rgb(random(0, 255), random(0, 255), random(0, 255))',
      duration: 3
    })

    // 6. 函式做為值 ---------------------------------
    const tween6 = gsap.to('.box8', {
      x: function (index, target, targets) {
        console.log(index, target, targets)
        // index: 索引值
        // target: 目標
        // targets: 目標陣列
        return 100 * (index + 1)
      }, 
      duration: 3
    })

    // 7. 設定 CSS 屬性
    const tween7 = gsap.to('.box9', {
      // 設定CSS屬性
      x: '+=random(-50, 50)', 
      y: '+=random(-50, 50)',
      rotation: 720, 
      scale: 1.5, 
      skewX: 10, 
      skewY: 10,
      width: 100, 
      height: 100,
      border: '2px solid red',
      boxShadow: '0 0 10px rgba(255, 0, 0, 1)',
      backgroundColor: 'transparent',
      backdropFilter: 'blur(5px)',
      // 設定動畫控制屬性
      repeat: 5, 
      repeatRefresh: true, 
      duration: 1
    })

    // 設定CSS文字屬性
    // 實例化物件 ex: new Date()
    const word = gsap.to('#word', {
      // random也可以用 repeat
      color: 'random([red, green, blue])',
      fontWeight: 'bold',
      fontSize: '1.5rem', 
      lineHeight: 1.5, 
      letterSpacing: '1rem',
      repeat: 4, 
      repeatRefresh: true, 
      duration: 2
    })

    // 8. 設定動畫屬性
    // 動畫播放次數 = 4, 初始撥放1次 + 重複播放3次 
    gsap.to('.box10', {
      x: 1000,
      borderRadius: (i, t, a) => {
        return '50%'
      },
      paused: true, 
      duration: 2,
      delay: 1, // 初始播放延遲時間
      yoyo: true, // 重複來回播放
      repeat: 3, // 重複次數-1 = 無限repeat
      repeatDelay: 2, // 重複播放延遲時間
      // https://gsap.com/docs/v3/Eases
      ease: "steps(12)",
      y: -500,
      yoyoEase: 'back', // 重複來回撥放的動畫速度曲線
    })
    $('#play').on('click', function() {
      tween8.play()
    })

    $('#pause').on('click', function(){
      tween8.pause()
    })

    // 9. keyframes 關鍵影格
    const tween9 = gsap.to('.box11', {
      // 整圈要重覆要寫在最外面 不能放在影格內 不然會是每個影格都重複
      repeat: -1,
      // 關鍵影格重複的程式碼可以提取到defaults中
      defaults: {
        duration: 1, 
        delay: 1, 
        ease: 'elastic'
      },
      // 有多個 所以用陣列
      keyframes: [
        // A
        {
          x: 200, 
          rotation: 360,
        }, 
        // B
        {
          y: 100, 
          scale: 0.1,
          duration: 3,  // 可覆蓋 defaults值
          ease: 'steps(3)' // 可覆蓋
        },
        // C
        {
          x: 0, 
          rotation: -360, 
          scale: 1.5,
        },
        // D
        {
          y: 0, 
          scale: 1, 
        }
      ]
    })
  </script>
</body>
</html>